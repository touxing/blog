(window.webpackJsonp=window.webpackJsonp||[]).push([[83],{363:function(s,t,a){"use strict";a.r(t);var n=a(7),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("img",{attrs:{src:s.$withBase("/img/640.jpg")}}),s._v(" "),t("blockquote",[t("p",[s._v("éšç€å‰ç«¯å˜é©ï¼ŒNginxä¹Ÿæˆä¸ºäº†å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆå¿…ä¸å¯å°‘åº”è¯¥å…·å¤‡çš„ä¸€é¡¹æŠ€èƒ½äº†ï¼Œé‚£nginxåˆ°åº•èµ·çš„æ˜¯å—ä½œç”¨ï¼Ÿå…¶å®Nginxä¸€ç›´è·Ÿæˆ‘ä»¬æ¯æ¯ç›¸å…³ï¼Œå®ƒæ—¢å¯ä»¥ä½œä¸º Web æœåŠ¡å™¨ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºè´Ÿè½½å‡è¡¡æœåŠ¡å™¨ï¼Œå…·å¤‡é«˜æ€§èƒ½ã€é«˜å¹¶å‘è¿æ¥ç­‰")])]),s._v(" "),t("h3",{attrs:{id:"_1-è´Ÿè½½å‡è¡¡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-è´Ÿè½½å‡è¡¡"}},[s._v("#")]),s._v(" 1.è´Ÿè½½å‡è¡¡")]),s._v(" "),t("blockquote",[t("p",[s._v("å½“ä¸€ä¸ªåº”ç”¨å•ä½æ—¶é—´å†…è®¿é—®é‡æ¿€å¢ï¼ŒæœåŠ¡å™¨çš„å¸¦å®½åŠæ€§èƒ½å—åˆ°å½±å“ï¼Œå½±å“å¤§åˆ°è‡ªèº«æ‰¿å—èƒ½åŠ›æ—¶ï¼ŒæœåŠ¡å™¨å°±ä¼šå®•æœºå¥”æºƒï¼Œä¸ºäº†é˜²æ­¢è¿™ç§ç°è±¡å‘ç”Ÿï¼Œä»¥åŠå®ç°æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é…ç½®Nginxè´Ÿè½½å‡è¡¡çš„æ–¹å¼æ¥åˆ†æ‹…æœåŠ¡å™¨å‹åŠ›")])]),s._v(" "),t("p",[s._v("å½“æœ‰ä¸€å°æœåŠ¡å™¨å®•æœºæ—¶ï¼Œè´Ÿè½½å‡è¡¡å™¨å°±åˆ†é…å…¶ä»–çš„æœåŠ¡å™¨ç»™ç”¨æˆ·ï¼Œæå¤§çš„å¢åŠ çš„ç½‘ç«™çš„ç¨³å®šæ€§ å½“ç”¨æˆ·è®¿é—®webæ—¶å€™ï¼Œé¦–å…ˆè®¿é—®åˆ°çš„æ˜¯è´Ÿè½½å‡è¡¡å™¨ï¼Œå†é€šè¿‡è´Ÿè½½å‡è¡¡å™¨å°†è¯·æ±‚è½¬å‘ç»™åå°æœåŠ¡å™¨")]),s._v(" "),t("h4",{attrs:{id:"_1-1-è´Ÿè½½å‡è¡¡çš„å‡ ç§å¸¸ç”¨æ–¹å¼"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-è´Ÿè½½å‡è¡¡çš„å‡ ç§å¸¸ç”¨æ–¹å¼"}},[s._v("#")]),s._v(" 1.1 è´Ÿè½½å‡è¡¡çš„å‡ ç§å¸¸ç”¨æ–¹å¼")]),s._v(" "),t("ul",[t("li",[s._v("è½®è¯¢ï¼ˆé»˜è®¤ï¼‰")])]),s._v(" "),t("div",{staticClass:"language-nginx line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nginx.config")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("upstream")]),s._v(" backserver")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server")]),s._v(" 192.168.0.1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server")]),s._v(" 192.168.0.2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("ul",[t("li",[s._v("æƒé‡weight")])]),s._v(" "),t("blockquote",[t("p",[s._v("æŒ‡å®šä¸åŒipçš„æƒé‡ï¼Œæƒé‡ä¸è®¿é—®æ¯”æˆæ­£ç›¸å…³ï¼Œæƒé‡è¶Šé«˜ï¼Œè®¿é—®è¶Šå¤§ï¼Œé€‚ç”¨äºä¸åŒæ€§èƒ½çš„æœºå™¨")])]),s._v(" "),t("div",{staticClass:"language-nginx line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nginx.config")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("upstream")]),s._v(" backserver")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server")]),s._v(" 192.168.0.1 weight=2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server")]),s._v(" 192.168.0.2 weight=8")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("ul",[t("li",[s._v("å“åº”æ—¶é—´æ¥åˆ†é…")])]),s._v(" "),t("blockquote",[t("p",[s._v("å…¬å¹³ç«äº‰ï¼Œè°ç›¸åº”å¿«ï¼Œè°å¤„ç†ï¼Œä¸è¿‡è¿™ç§æ–¹å¼éœ€è¦ä¾èµ–åˆ°ç¬¬ä¸‰æ–¹æ’ä»¶nginx-upstream-fairï¼Œéœ€è¦å…ˆå®‰è£…")])]),s._v(" "),t("div",{staticClass:"language-nginx line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nginx.config")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("upstream")]),s._v(" backserver")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server")]),s._v(" 192.168.0.1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server")]),s._v(" 192.168.0.2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fair")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("listen")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server_name")]),s._v(" localhost")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v(" /")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("proxy_pass")]),s._v("  http://backserver")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h4",{attrs:{id:"_1-2-å¥åº·æ£€æŸ¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-å¥åº·æ£€æŸ¥"}},[s._v("#")]),s._v(" 1.2 å¥åº·æ£€æŸ¥")]),s._v(" "),t("blockquote",[t("p",[s._v("Nginx è‡ªå¸¦ ngx_http_upstream_moduleï¼ˆå¥åº·æ£€æµ‹æ¨¡å—ï¼‰æœ¬è´¨ä¸ŠæœåŠ¡å™¨å¿ƒè·³çš„æ£€æŸ¥ï¼Œé€šè¿‡å®šæœŸè½®è¯¢å‘é›†ç¾¤é‡Œçš„æœåŠ¡å™¨å‘é€å¥åº·æ£€æŸ¥è¯·æ±‚,æ¥æ£€æŸ¥é›†ç¾¤ä¸­æ˜¯å¦æœ‰æœåŠ¡å™¨å¤„äºå¼‚å¸¸çŠ¶æ€")])]),s._v(" "),t("p",[s._v("å¦‚æœæ£€æµ‹å‡ºå…¶ä¸­æŸå°æœåŠ¡å™¨å¼‚å¸¸,é‚£ä¹ˆåœ¨é€šè¿‡å®¢æˆ·ç«¯è¯·æ±‚nginxåå‘ä»£ç†è¿›æ¥çš„éƒ½ä¸ä¼šè¢«å‘é€åˆ°è¯¥æœåŠ¡å™¨ä¸Šï¼ˆç›´è‡³ä¸‹æ¬¡è½®è®­å¥åº·æ£€æŸ¥æ­£å¸¸ï¼‰")]),s._v(" "),t("p",[s._v("åŸºæœ¬ä¾‹å­å¦‚ä¸‹ğŸ‘‡")]),s._v(" "),t("div",{staticClass:"language-nginx line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("upstream")]),s._v(" backserver")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server")]),s._v(" 192.168.0.1  max_fails=1 fail_timeout=40s")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server")]),s._v(" 192.168.0.2  max_fails=1 fail_timeout=40s")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("listen")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server_name")]),s._v(" localhost")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v(" /")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("proxy_pass")]),s._v(" http://backend")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("p",[s._v("æ¶‰åŠä¸¤ä¸ªé…ç½®ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("fail_timeout : è®¾å®šæœåŠ¡å™¨è¢«è®¤ä¸ºä¸å¯ç”¨çš„æ—¶é—´æ®µä»¥åŠç»Ÿè®¡å¤±è´¥å°è¯•æ¬¡æ•°çš„æ—¶é—´æ®µï¼Œé»˜è®¤ä¸º10s")]),s._v(" "),t("li",[s._v("max_fails : è®¾å®šNginxä¸æœåŠ¡å™¨é€šä¿¡çš„å°è¯•å¤±è´¥çš„æ¬¡æ•°ï¼Œé»˜è®¤ä¸ºï¼š1æ¬¡")])]),s._v(" "),t("h3",{attrs:{id:"_2-åå‘ä»£ç†"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-åå‘ä»£ç†"}},[s._v("#")]),s._v(" 2.åå‘ä»£ç†")]),s._v(" "),t("blockquote",[t("p",[s._v("åå‘ä»£ç†æŒ‡çš„æ˜¯ï¼Œå½“ä¸€ä¸ªå®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚,æƒ³è¦è®¿é—®æœåŠ¡å™¨ä¸Šçš„å†…å®¹ï¼Œä½†å°†è¢«è¯¥è¯·æ±‚å…ˆå‘é€åˆ°ä¸€ä¸ªä»£ç†æœåŠ¡å™¨proxy,è¿™ä¸ªä»£ç†æœåŠ¡å™¨ï¼ˆNginxï¼‰å°†æŠŠè¯·æ±‚ä»£ç†åˆ°å’Œè‡ªå·±å±äºåŒä¸€ä¸ªå±€åŸŸç½‘ä¸‹çš„å†…éƒ¨æœåŠ¡å™¨ä¸Š,è€Œç”¨æˆ·é€šè¿‡å®¢æˆ·ç«¯çœŸæ­£æƒ³è·å¾—çš„å†…å®¹å°±å­˜å‚¨åœ¨è¿™äº›å†…éƒ¨æœåŠ¡å™¨ä¸Šï¼Œæ­¤æ—¶Nginxä»£ç†æœåŠ¡å™¨æ‰¿æ‹…çš„è§’è‰²å°±æ˜¯ä¸€ä¸ªä¸­é—´äººï¼Œèµ·åˆ°åˆ†é…å’Œæ²Ÿé€šçš„ä½œç”¨")])]),s._v(" "),t("h4",{attrs:{id:"_2-1-ä¸ºä»€ä¹ˆéœ€è¦åå‘ä»£ç†"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-ä¸ºä»€ä¹ˆéœ€è¦åå‘ä»£ç†"}},[s._v("#")]),s._v(" 2.1  ä¸ºä»€ä¹ˆéœ€è¦åå‘ä»£ç†ï¼Ÿ")]),s._v(" "),t("p",[s._v("åå‘ä»£ç†çš„ä¼˜åŠ¿ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç‚¹")]),s._v(" "),t("ul",[t("li",[s._v("é˜²ç«å¢™ä½œç”¨")])]),s._v(" "),t("p",[s._v("å½“ä½ çš„åº”ç”¨ä¸æƒ³ç›´æ¥æš´éœ²ç»™å®¢æˆ·ç«¯ï¼ˆä¹Ÿå°±æ˜¯å®¢æˆ·ç«¯æ— æ³•ç›´æ¥é€šè¿‡è¯·æ±‚è®¿é—®çœŸæ­£çš„æœåŠ¡å™¨ï¼Œåªèƒ½é€šè¿‡Nginxï¼‰ï¼Œé€šè¿‡nginxè¿‡æ»¤æ‰æ²¡æœ‰æƒé™æˆ–è€…éæ³•çš„è¯·æ±‚ï¼Œæ¥ä¿éšœå†…éƒ¨æœåŠ¡å™¨çš„å®‰å…¨")]),s._v(" "),t("ul",[t("li",[s._v("è´Ÿè½½å‡è¡¡")])]),s._v(" "),t("p",[s._v('ä¹Ÿå°±ä¸Šä¸€ç« æåˆ°è´Ÿè½½å‡è¡¡ï¼Œæœ¬è´¨ä¸Šè´Ÿè½½å‡è¡¡å°±æ˜¯åå‘ä»£ç†çš„ä¸€ç§åº”ç”¨åœºæ™¯ï¼Œå¯ä»¥é€šè¿‡nginxå°†æ¥æ”¶åˆ°çš„å®¢æˆ·ç«¯è¯·æ±‚"å‡åŒ€åœ°"åˆ†é…åˆ°è¿™ä¸ªé›†ç¾¤ä¸­æ‰€æœ‰çš„æœåŠ¡å™¨ä¸Š(å…·ä½“çœ‹è´Ÿè½½å‡è¡¡æ–¹å¼),ä»è€Œå®ç°æœåŠ¡å™¨å‹åŠ›çš„è´Ÿè½½å‡è¡¡')]),s._v(" "),t("h4",{attrs:{id:"_2-2-å¦‚ä½•ä½¿ç”¨åå‘ä»£ç†"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-å¦‚ä½•ä½¿ç”¨åå‘ä»£ç†"}},[s._v("#")]),s._v(" 2.2 å¦‚ä½•ä½¿ç”¨åå‘ä»£ç†")]),s._v(" "),t("blockquote",[t("p",[s._v("æˆ‘ä»¬é€šè¿‡æ¨¡æ‹Ÿå†…éƒ¨æœåŠ¡å™¨çš„ç«¯å£å¯åŠ¨çš„nodejsé¡¹ç›®è®¾ç½®åå‘ä»£ç†åˆ°80ç«¯å£è®¿é—®")])]),s._v(" "),t("div",{staticClass:"language-nginx line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nginx.config")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server")])]),s._v("  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("listen")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server_name")]),s._v(" localhost")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v(" /")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("proxy_pass")]),s._v(" http://127.0.0.1:8000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("ï¼ˆupstreamï¼‰\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("åœ¨ Nginx åå‘ä»£ç†æ˜¯ï¼Œä¼šé€šè¿‡ location åŠŸèƒ½åŒ¹é…æŒ‡å®šçš„ URIï¼Œç„¶åæŠŠæ¥æ”¶åˆ°çš„ç¬¦åˆåŒ¹é… URIçš„è¯·æ±‚é€šè¿‡ proxy_pass è½¬ç§»ç»™ä¹‹å‰å®šä¹‰å¥½çš„ upstream èŠ‚ç‚¹æ± ")]),s._v(" "),t("h3",{attrs:{id:"_3-https-é…ç½®"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-https-é…ç½®"}},[s._v("#")]),s._v(" 3.Https é…ç½®")]),s._v(" "),t("blockquote",[t("p",[s._v("Nginx å¸¸ç”¨æ¥é…ç½®Httpsè®¤è¯ï¼Œä¸»è¦æœ‰ä¸¤ä¸ªæ­¥éª¤ï¼šç­¾ç½²ç¬¬ä¸‰æ–¹å¯ä¿¡ä»»çš„ SSL è¯ä¹¦ å’Œ é…ç½® HTTPS")])]),s._v(" "),t("h4",{attrs:{id:"_3-1-ç­¾ç½²ç¬¬ä¸‰æ–¹å¯ä¿¡ä»»çš„-ssl"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-ç­¾ç½²ç¬¬ä¸‰æ–¹å¯ä¿¡ä»»çš„-ssl"}},[s._v("#")]),s._v(" 3.1 ç­¾ç½²ç¬¬ä¸‰æ–¹å¯ä¿¡ä»»çš„ SSL")]),s._v(" "),t("blockquote",[t("p",[s._v("é…ç½® HTTPS è¦ç”¨åˆ°ç§é’¥ example.key æ–‡ä»¶å’Œ example.crt è¯ä¹¦æ–‡ä»¶ï¼Œè€Œç”³è¯·è¯ä¹¦æ–‡ä»¶çš„æ—¶å€™è¦ç”¨åˆ° example.csr æ–‡ä»¶ã€‚å¯¹äºæƒ³äº†è§£æ›´å¤šå…³äºSSLè¯ä¹¦çš„ç‚¹è¿™é‡ŒSSLè¯ä¹¦ä»‹ç»")])]),s._v(" "),t("h4",{attrs:{id:"_3-2-nginxé…ç½®https"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-nginxé…ç½®https"}},[s._v("#")]),s._v(" 3.2 Nginxé…ç½®https")]),s._v(" "),t("blockquote",[t("p",[s._v("è¦å¼€å¯ HTTPS æœåŠ¡ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¿¡æ¯å—(server)ï¼Œå¿…é¡»ä½¿ç”¨ç›‘å¬å‘½ä»¤ listen çš„ ssl å‚æ•°å’Œå®šä¹‰æœåŠ¡å™¨è¯ä¹¦æ–‡ä»¶å’Œç§é’¥æ–‡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š")])]),s._v(" "),t("div",{staticClass:"language-nginx line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#sslå‚æ•°")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("listen")]),s._v("              "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v(" ssl")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" //ç›‘å¬443ç«¯å£ï¼Œå› ä¸º443ç«¯å£æ˜¯httpsçš„é»˜è®¤ç«¯å£ã€‚80ä¸ºhttpçš„é»˜è®¤ç«¯å£\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server_name")]),s._v("         example.com")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#è¯ä¹¦æ–‡ä»¶")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ssl_certificate")]),s._v("     example.com.crt")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ç§é’¥æ–‡ä»¶")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ssl_certificate_key")]),s._v(" example.com.key")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("ul",[t("li",[s._v("ssl_certificate:è¯ä¹¦çš„ç»å¯¹è·¯å¾„")]),s._v(" "),t("li",[s._v("ssl_certificate_key:  å¯†é’¥çš„ç»å¯¹è·¯å¾„;")])]),s._v(" "),t("h3",{attrs:{id:"_4-å¸¸ç”¨çš„é…ç½®"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-å¸¸ç”¨çš„é…ç½®"}},[s._v("#")]),s._v(" 4.å¸¸ç”¨çš„é…ç½®")]),s._v(" "),t("blockquote",[t("p",[s._v("é™¤äº†ä¸Šè¿°çš„è¿™äº›ï¼Œå‰ç«¯è¿˜å¯ä»¥ç”¨Nginxåšäº›ä»€ä¹ˆï¼Œå¤šç€å‘¢ï½ä¸‹é¢ä¾ä¾ç»™ä½ è®²")])]),s._v(" "),t("h4",{attrs:{id:"_4-1-ipç™½åå•"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-ipç™½åå•"}},[s._v("#")]),s._v(" 4.1 IPç™½åå•")]),s._v(" "),t("blockquote",[t("p",[s._v("å¯ä»¥é…ç½®nginxçš„ç™½åå•ï¼Œè§„å®šæœ‰å“ªäº›ipå¯ä»¥è®¿é—®ä½ çš„æœåŠ¡å™¨ï¼Œé˜²çˆ¬è™«å¿…å¤‡")])]),s._v(" "),t("ul",[t("li",[s._v("ç®€å•é…ç½®")])]),s._v(" "),t("div",{staticClass:"language-nginx line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v(" /")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("deny")]),s._v("  192.168.0.1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" // ç¦æ­¢è¯¥ipè®¿é—®\n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("deny")]),s._v("  all")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" // ç¦æ­¢æ‰€æœ‰\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("ul",[t("li",[s._v("ç™½åå•é…ç½®")])]),s._v(" "),t("p",[s._v("å»ºç«‹ç™½åå•")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/nginx/white_ip.conf\n "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.1 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("ä¿®æ”¹nginxé…ç½®(nginx.conf)")]),s._v(" "),t("div",{staticClass:"language-nginx line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("geo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$remote_addr")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ip_whitelist")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("include")]),s._v(" ip.conf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n// geo æŒ‡ä»¤ä¸»è¦æ˜¯å¯ä»¥æ ¹æ®æŒ‡å®šå˜é‡çš„å€¼æ˜ å°„å‡ºä¸€ä¸ªæ–°å˜é‡ã€‚å¦‚æœä¸æŒ‡å®šå˜é‡ï¼Œé»˜è®¤ä¸º$remote_addr\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("ä¸ºåŒ¹é…é¡¹åšç™½åå•è®¾ç½®")]),s._v(" "),t("div",{staticClass:"language-nginx line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v(" /")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" ( "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ip_whitelist")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" )")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("403")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" //ä¸åœ¨ç™½åå•è¿”å› 403\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("index")]),s._v(" index.html")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("root")]),s._v(" /tmp")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h4",{attrs:{id:"_4-2-é€‚é…pcä¸ç§»åŠ¨ç¯å¢ƒ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-é€‚é…pcä¸ç§»åŠ¨ç¯å¢ƒ"}},[s._v("#")]),s._v(" 4.2 é€‚é…PCä¸ç§»åŠ¨ç¯å¢ƒ")]),s._v(" "),t("blockquote",[t("p",[s._v("å½“ç”¨æˆ·ä»ç§»åŠ¨ç«¯æ‰“å¼€PCç«¯baidu.comçš„åœºæ™¯æ—¶ï¼Œå°†è‡ªåŠ¨è·³è½¬æŒ‡ç§»åŠ¨ç«¯m.baidu.comï¼Œæœ¬è´¨ä¸Šæ˜¯Nginxå¯ä»¥é€šè¿‡å†…ç½®å˜é‡$http_user_agentï¼Œè·å–åˆ°è¯·æ±‚å®¢æˆ·ç«¯çš„userAgentï¼Œä»è€ŒçŸ¥é“å½“å‰ç”¨æˆ·å½“å‰ç»ˆç«¯æ˜¯ç§»åŠ¨ç«¯è¿˜æ˜¯PCï¼Œè¿›è€Œé‡å®šå‘åˆ°H5ç«™è¿˜æ˜¯PCç«™")])]),s._v(" "),t("div",{staticClass:"language-nginx line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v(" /")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    //ç§»åŠ¨ã€pcè®¾å¤‡agentè·å–\n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" ("),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$http_user_agent")]),s._v(" ~* "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'(Android|webOS|iPhone)'")]),s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$mobile_request")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1'")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" ("),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$mobile_request")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1'")]),s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rewrite")]),s._v(" ^.+ http://m.baidu.com")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h4",{attrs:{id:"_4-3-é…ç½®gzip"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-é…ç½®gzip"}},[s._v("#")]),s._v(" 4.3 é…ç½®gzip")]),s._v(" "),t("blockquote",[t("p",[s._v("å¼€å¯Nginx gzipï¼Œå‹ç¼©å,é™æ€èµ„æºçš„å¤§å°ä¼šå¤§å¤§çš„å‡å°‘,ä»è€Œå¯ä»¥èŠ‚çº¦å¤§é‡çš„å¸¦å®½,æé«˜ä¼ è¾“æ•ˆç‡,å¸¦æ¥æ›´å¥½çš„å“åº”å’Œä½“éªŒ")])]),s._v(" "),t("div",{staticClass:"language-nginx line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("gzip")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("on")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" //å¯åŠ¨\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("gzip_buffers")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4K")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("gzip_comp_level")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" //å‹ç¼©çº§åˆ«ï¼Œ1-10ï¼Œæ•°å­—è¶Šå¤§å‹ç¼©çš„è¶Šå¥½\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("gzip_min_length")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" //ä¸å‹ç¼©ä¸´ç•Œå€¼ï¼Œå¤§äº100çš„æ‰å‹ç¼©ï¼Œä¸€èˆ¬ä¸ç”¨æ”¹\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("gzip_types")]),s._v(" application/javascript text/css text/xml")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("gzip_disable")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MSIE [1-6]\\."')])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" // "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IE6å¯¹Gzipä¸å‹å¥½ï¼Œå¯¹Gzip")]),s._v("\n  gzip_vary "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("on")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h4",{attrs:{id:"_4-4-nginxé…ç½®è·¨åŸŸè¯·æ±‚"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-nginxé…ç½®è·¨åŸŸè¯·æ±‚"}},[s._v("#")]),s._v(" 4.4 Nginxé…ç½®è·¨åŸŸè¯·æ±‚")]),s._v(" "),t("blockquote",[t("p",[s._v("å½“å‡ºç°403è·¨åŸŸé”™è¯¯çš„æ—¶å€™ï¼Œè¿˜æœ‰ No 'Access-Control-Allow-Origin' header is present on the requested resourceæŠ¥é”™ç­‰ï¼Œéœ€è¦ç»™NginxæœåŠ¡å™¨é…ç½®å“åº”çš„headerå‚æ•°ï¼š")])]),s._v(" "),t("div",{staticClass:"language-nginx line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v(" /")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("add_header")]),s._v(" Access-Control-Allow-Origin *")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("add_header")]),s._v(" Access-Control-Allow-Methods "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'GET, POST, OPTIONS'")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("add_header")]),s._v(" Access-Control-Allow-Headers "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization'")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" ("),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$request_method")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'OPTIONS'")]),s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("204")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h3",{attrs:{id:"_5-å¦‚ä½•ä½¿ç”¨nginx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-å¦‚ä½•ä½¿ç”¨nginx"}},[s._v("#")]),s._v(" 5.å¦‚ä½•ä½¿ç”¨Nginx")]),s._v(" "),t("blockquote",[t("p",[s._v("é€šè¿‡åœ¨æœ¬åœ°ä½¿ç”¨Nginxï¼Œä»å¯åŠ¨ã€æ›´æ”¹ã€é‡å¯ç­‰ç¯èŠ‚æ¥ä»‹ç»Nginxçš„åŸºæœ¬ä½¿ç”¨")])]),s._v(" "),t("ul",[t("li",[s._v("å¦‚ä½•å¯åŠ¨"),t("code",[s._v("sudo nginx")])]),s._v(" "),t("li",[s._v("ä¿®æ”¹nginx.conf é…ç½® (å…·ä½“çœ‹ä½ é…ç½®ä½ç½®)"),t("code",[s._v("vim /usr/local/etc/nginx/nginx.conf")])]),s._v(" "),t("li",[s._v("æ£€æŸ¥è¯­æ³•æ˜¯å¦æ­£å¸¸ "),t("code",[s._v("sudo nginx -t")])]),s._v(" "),t("li",[s._v("é‡å¯nginx "),t("code",[s._v("sudo nginx -s reload")])]),s._v(" "),t("li",[s._v("åˆ›å»ºè½¯é“¾æ¥(ä¾¿äºç®¡ç†å¤šåº”ç”¨nginx)")])]),s._v(" "),t("blockquote",[t("p",[s._v("å½“æˆ‘ä»¬éœ€è¦ç®¡ç†å¤šä¸ªç½‘ç«™çš„nginxï¼Œnginxæ–‡ä»¶æ”¾åœ¨ä¸€èµ·æ˜¯æœ€å¥½çš„ç®¡ç†æ–¹å¼ï¼Œä¸€èˆ¬éƒ½å­˜åœ¨/nginx/conf.d/ï¼Œæˆ‘ä»¬éœ€è¦æŠŠé…ç½®æ–‡ä»¶ä¸¢åˆ° /etc/nginx/conf.d/ æ–‡ä»¶å¤¹ä¸‹ï¼Œæ€æ ·æ‰èƒ½ä½¿è¿™ä¸ªé…ç½®æ–‡ä»¶æ—¢åœ¨ç¨‹åºæ–‡ä»¶å¤¹ä¸‹ï¼Œåˆåœ¨ /etc/nginx/conf.d/æ–‡ä»¶å¤¹ä¸‹å‘¢ï¼Ÿ")])]),s._v(" "),t("p",[s._v("å‡å¦‚æˆ‘ä»¬åœ¨ç¨‹åºæ–‡ä»¶å¤¹ä¸‹æœ‰ä¸€ä¸ª ngxin é…ç½®æ–‡ä»¶ï¼š/home/app/app.nginx.conf æˆ‘ä»¬éœ€è¦ç»™è¿™ä¸ªæ–‡ä»¶åˆ›å»ºä¸€ä¸ªè½¯é“¾æ¥åˆ° /etc/nginx/conf.d/ ä¸‹ï¼š")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("ln -s /home/app/app.example.com.nginx.conf /etc/nginx/conf.d/app.nginx.conf\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("è¿™æ ·æ“ä½œä¹‹åï¼Œå½“æˆ‘ä»¬æ”¹åº”ç”¨é…ç½®æ–‡ä»¶ï¼Œ/etc/nginx/conf.d/ ä¸‹ä¸ä¹‹å¯¹åº”çš„é…ç½®æ–‡ä»¶ä¹Ÿä¼šè¢«ä¿®æ”¹ï¼Œä¿®æ”¹åé‡å¯ nginx å°±èƒ½å¤Ÿä½¿æ–°çš„ ngxin é…ç½®ç”Ÿæ•ˆäº†ã€‚")])])}),[],!1,null,null,null);t.default=e.exports}}]);